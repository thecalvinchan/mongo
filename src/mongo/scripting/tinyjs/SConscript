# -*- mode: python -*-

Import('env')

env.Library(
    target='ast_parser',
    source=[
        'ast_parser.cpp',
        'array_literal.cpp',
        'binary_operator.cpp',
        'nonterminal_node.cpp',
        'terminal_node.cpp',
        'identifier.cpp',
        'scope.cpp',
        'ternary_operator.cpp',
        'unary_operator.cpp',
        'object_accessor_operator.cpp',
        'multiplication_operator.cpp',
        'division_operator.cpp',
        'addition_operator.cpp',
        'subtraction_operator.cpp',
        'triple_equals_operator.cpp',
        'double_equals_operator.cpp',
        'greater_than_operator.cpp',
        'greater_than_equals_operator.cpp',
        'less_than_operator.cpp',
        'less_than_equals_operator.cpp',
        'not_equals_operator.cpp',
        'double_not_equals_operator.cpp',
        'logical_and_operator.cpp',
        'logical_or_operator.cpp'
    ],
    LIBDEPS=[
        '$BUILD_DIR/mongo/db/pipeline/document_value',
        '$BUILD_DIR/mongo/scripting/scripting_common',
        '$BUILD_DIR/mongo/client/clientdriver'
    ]
)

env.Library(
    target='lexer',
    source=[
        'lexer.cpp', 
    ]
)

env.Library(
    target='engine_test',
    source=[
        'engine_test.cpp', 
    ], 
    LIBDEPS=[
        'lexer', 
        'ast_parser', 
    ]
)

env.CppUnitTest(
    target='ast_parser_test',
    source=[
        'ast_parser_test.cpp',
    ],
    LIBDEPS=[
        'ast_parser',
        'lexer'
    ],
)

env.CppUnitTest(
    target='lexer_test',
    source=[
        'lexer_test.cpp'
    ], 
    LIBDEPS=[
        'lexer'
    ]
)

env.CppUnitTest(
    target='evaluation_test',
    source=[
        'evaluation_test.cpp'
    ], 
    LIBDEPS=[
        'ast_parser', 
        'lexer',
        '$BUILD_DIR/mongo/bson/mutable/mutable_bson'
    ]
)
